<div class="income-container">
  <header class="income-header">
    <h1>Receitas</h1>
    <button class="btn-new-transaction" (click)="showCreateForm()">
      + Nova Receita
    </button>
  </header>

  <div class="loading" *ngIf="loading">
    <p>Carregando receitas...</p>
  </div>

  <div class="error" *ngIf="errorMessage">
    {{ errorMessage }}
    <button class="btn btn-secondary" (click)="loadIncomes()" style="margin-left: 10px;">
      Tentar novamente
    </button>
  </div>

  <div class="incomes-section" *ngIf="incomes.length > 0">
    <div class="incomes-table">
      <div class="table-header">
        <div class="header-cell">Origem do Pagamento</div>
        <div class="header-cell">Categoria</div>
        <div class="header-cell">Data</div>
        <div class="header-cell">Conta</div>
        <div class="header-cell">Valor</div>
        <div class="header-cell">Ações</div>
      </div>

      <div *ngFor="let income of incomes" class="table-row">
        <div class="cell">
          <div class="transaction-icon income-icon">+</div>
          {{ income.paymentOrigin }}
        </div>
        <div class="cell">{{ getCategoryName(income) }}</div>
        <div class="cell">{{ formatDate(income.date) }}</div>
        <div class="cell">{{ income.balanceSource }}</div>
        <div class="cell income-amount">+R$ {{ income.amount | number:'1.2-2' }}</div>
        <div class="cell actions">
          <button class="btn-edit" (click)="editIncome(income)">Editar</button>
          <button class="btn-delete" (click)="deleteIncome(income.incomeId)">Excluir</button>
        </div>
      </div>
    </div>
  </div>

  <div class="no-incomes" *ngIf="incomes.length === 0 && !loading && !errorMessage">
    <p>Nenhuma receita encontrada</p>
  </div>

  <app-income-form *ngIf="showForm" [incomeToEdit]="selectedIncome" [editMode]="isEditMode"
    (formSubmit)="onFormSubmit()" (formCancel)="onFormCancel()">
  </app-income-form>
</div>